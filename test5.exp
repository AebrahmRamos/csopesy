#!/usr/bin/expect -f
set timeout 30

spawn ./csopesy

expect "Enter a command:"
send "initialize\r"

expect "Enter a command:"
send "scheduler-test\r"

sleep 5

expect "Enter a command:"
send "scheduler-stop\r"

# Check process-smi periodically for 10 seconds
for {set i 0} {$i < 5} {incr i} {
    expect "Enter a command:"
    send "process-smi\r"
    sleep 2
}

expect "Enter a command:"
send "vmstat\r"

expect "Enter a command:"
send "exit\r"

expect eof